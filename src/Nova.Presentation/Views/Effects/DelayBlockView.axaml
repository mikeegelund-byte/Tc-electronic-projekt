<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:vm="using:Nova.Presentation.ViewModels.Effects"
             x:Class="Nova.Presentation.Views.Effects.DelayBlockView"
             x:DataType="vm:DelayBlockViewModel">

  <Border Background="{StaticResource BackgroundPrimary}"
          Padding="{StaticResource SpacingMedium}"
          CornerRadius="{StaticResource BorderRadiusMedium}">
    <StackPanel Spacing="8">
      <StackPanel Orientation="Horizontal" Spacing="8">
        <Ellipse Width="12" Height="12"
                 Fill="{Binding IsEnabled, Converter={StaticResource BoolToGreenGrayBrushConverter}}"
                 VerticalAlignment="Center" />
        <TextBlock Text="Delay"
                   FontWeight="{StaticResource FontWeightBold}"
                   Foreground="{StaticResource TextPrimary}"/>
      </StackPanel>

      <Grid ColumnDefinitions="160,*" RowDefinitions="Auto,Auto,Auto,Auto,Auto,Auto">
        <TextBlock Grid.Row="0" Grid.Column="0" Text="Type:" Foreground="{StaticResource TextSecondary}"/>
        <TextBlock Grid.Row="0" Grid.Column="1" Text="{Binding Type}" Foreground="{StaticResource TextPrimary}"/>

        <TextBlock Grid.Row="1" Grid.Column="0" Text="Time:" Foreground="{StaticResource TextSecondary}"/>
        <StackPanel Grid.Row="1" Grid.Column="1" Orientation="Horizontal" Spacing="4">
          <NumericUpDown Value="{Binding Time}" Minimum="0" Maximum="1800" Increment="10" FormatString="N0" MinWidth="80" />
          <TextBlock Text="ms" VerticalAlignment="Center" Foreground="{StaticResource TextTertiary}" />
        </StackPanel>

        <TextBlock Grid.Row="2" Grid.Column="0" Text="Tempo:" Foreground="{StaticResource TextSecondary}"/>
        <NumericUpDown Grid.Row="2" Grid.Column="1" Value="{Binding Tempo}" Minimum="0" Maximum="16" Increment="1" FormatString="N0" MinWidth="80" />

        <TextBlock Grid.Row="3" Grid.Column="0" Text="Feedback:" Foreground="{StaticResource TextSecondary}"/>
          <StackPanel Grid.Row="3" Grid.Column="1" Orientation="Horizontal" Spacing="4">
            <NumericUpDown Value="{Binding Feedback}" Minimum="0" Maximum="120" Increment="1" FormatString="N0" MinWidth="80"
                           ToolTip.Tip="Delay feedback amount (0-120%)" />
          <TextBlock Text="%" VerticalAlignment="Center" Foreground="{StaticResource TextTertiary}" />
        </StackPanel>

        <TextBlock Grid.Row="4" Grid.Column="0" Text="Hi Cut:" Foreground="{StaticResource TextSecondary}"/>
        <NumericUpDown Grid.Row="4" Grid.Column="1" Value="{Binding HiCut}" Minimum="0" Maximum="61" Increment="1" FormatString="N0" MinWidth="80" />

        <TextBlock Grid.Row="5" Grid.Column="0" Text="Lo Cut:" Foreground="{StaticResource TextSecondary}"/>
        <NumericUpDown Grid.Row="5" Grid.Column="1" Value="{Binding LoCut}" Minimum="0" Maximum="61" Increment="1" FormatString="N0" MinWidth="80" />
      </Grid>

      <Grid ColumnDefinitions="160,*" RowDefinitions="Auto">
        <TextBlock Grid.Row="0" Grid.Column="0" Text="Mix:" Foreground="{StaticResource TextSecondary}"/>
        <StackPanel Grid.Row="0" Grid.Column="1" Orientation="Horizontal" Spacing="4">
          <NumericUpDown Value="{Binding Mix}" Minimum="0" Maximum="100" Increment="1" FormatString="N0" MinWidth="80" />
          <TextBlock Text="%" VerticalAlignment="Center" Foreground="{StaticResource TextTertiary}" />
        </StackPanel>
      </Grid>

      <StackPanel Spacing="8" IsVisible="{Binding IsAnalog}">
        <TextBlock Text="Analog" FontWeight="{StaticResource FontWeightSemiBold}" Foreground="{StaticResource TextPrimary}"/>
        <Grid ColumnDefinitions="160,*" RowDefinitions="Auto">
          <TextBlock Grid.Row="0" Grid.Column="0" Text="Clip:" Foreground="{StaticResource TextSecondary}"/>
          <StackPanel Grid.Row="0" Grid.Column="1" Orientation="Horizontal" Spacing="4">
            <NumericUpDown Value="{Binding ClipOrFeedback2}" Minimum="0" Maximum="24" Increment="1" FormatString="N0" MinWidth="80"
                           ToolTip.Tip="Analog clip amount (dB)" />
            <TextBlock Text="dB" VerticalAlignment="Center" Foreground="{StaticResource TextTertiary}" />
          </StackPanel>
        </Grid>
      </StackPanel>

      <StackPanel Spacing="8" IsVisible="{Binding IsTape}">
        <TextBlock Text="Tape" FontWeight="{StaticResource FontWeightSemiBold}" Foreground="{StaticResource TextPrimary}"/>
        <Grid ColumnDefinitions="160,*" RowDefinitions="Auto">
          <TextBlock Grid.Row="0" Grid.Column="0" Text="Clip:" Foreground="{StaticResource TextSecondary}"/>
          <StackPanel Grid.Row="0" Grid.Column="1" Orientation="Horizontal" Spacing="4">
            <NumericUpDown Value="{Binding ClipOrFeedback2}" Minimum="0" Maximum="24" Increment="1" FormatString="N0" MinWidth="80"
                           ToolTip.Tip="Tape clip amount (dB)" />
            <TextBlock Text="dB" VerticalAlignment="Center" Foreground="{StaticResource TextTertiary}" />
          </StackPanel>
        </Grid>
      </StackPanel>

      <StackPanel Spacing="8" IsVisible="{Binding IsDynamic}">
        <TextBlock Text="Dynamic" FontWeight="{StaticResource FontWeightSemiBold}" Foreground="{StaticResource TextPrimary}"/>
        <Grid ColumnDefinitions="160,*" RowDefinitions="Auto,Auto,Auto,Auto">
          <TextBlock Grid.Row="0" Grid.Column="0" Text="Offset:" Foreground="{StaticResource TextSecondary}"/>
          <StackPanel Grid.Row="0" Grid.Column="1" Orientation="Horizontal" Spacing="4">
            <NumericUpDown Value="{Binding OffsetOrPan1}" Minimum="-200" Maximum="200" Increment="1" FormatString="N0" MinWidth="80"
                           ToolTip.Tip="Dynamic: time offset between dry and delayed signal (ms)" />
            <TextBlock Text="ms" VerticalAlignment="Center" Foreground="{StaticResource TextTertiary}" />
          </StackPanel>

          <TextBlock Grid.Row="1" Grid.Column="0" Text="Sense:" Foreground="{StaticResource TextSecondary}"/>
          <StackPanel Grid.Row="1" Grid.Column="1" Orientation="Horizontal" Spacing="4">
            <NumericUpDown Value="{Binding SenseOrPan2}" Minimum="-50" Maximum="0" Increment="1" FormatString="N0" MinWidth="80"
                           ToolTip.Tip="Dynamic: input sensitivity threshold (dB)" />
            <TextBlock Text="dB" VerticalAlignment="Center" Foreground="{StaticResource TextTertiary}" />
          </StackPanel>

          <TextBlock Grid.Row="2" Grid.Column="0" Text="Damp:" Foreground="{StaticResource TextSecondary}"/>
          <StackPanel Grid.Row="2" Grid.Column="1" Orientation="Horizontal" Spacing="4">
            <NumericUpDown Value="{Binding Damp}" Minimum="0" Maximum="100" Increment="1" FormatString="N0" MinWidth="80"
                           ToolTip.Tip="Dynamic: high-frequency damping (dB)" />
            <TextBlock Text="dB" VerticalAlignment="Center" Foreground="{StaticResource TextTertiary}" />
          </StackPanel>

          <TextBlock Grid.Row="3" Grid.Column="0" Text="Release:" Foreground="{StaticResource TextSecondary}"/>
          <NumericUpDown Grid.Row="3" Grid.Column="1" Value="{Binding Release}" Minimum="11" Maximum="21" Increment="1" FormatString="N0" MinWidth="80"
                         ToolTip.Tip="Dynamic: release time (11-21)" />
        </Grid>
      </StackPanel>

      <StackPanel Spacing="8" IsVisible="{Binding IsDual}">
        <TextBlock Text="Dual" FontWeight="{StaticResource FontWeightSemiBold}" Foreground="{StaticResource TextPrimary}"/>
        <Grid ColumnDefinitions="160,*" RowDefinitions="Auto,Auto,Auto,Auto">
          <TextBlock Grid.Row="0" Grid.Column="0" Text="Time 2:" Foreground="{StaticResource TextSecondary}"/>
          <StackPanel Grid.Row="0" Grid.Column="1" Orientation="Horizontal" Spacing="4">
            <NumericUpDown Value="{Binding Time2}" Minimum="0" Maximum="1800" Increment="10" FormatString="N0" MinWidth="80" />
            <TextBlock Text="ms" VerticalAlignment="Center" Foreground="{StaticResource TextTertiary}" />
          </StackPanel>

          <TextBlock Grid.Row="1" Grid.Column="0" Text="Tempo 2:" Foreground="{StaticResource TextSecondary}"/>
          <NumericUpDown Grid.Row="1" Grid.Column="1" Value="{Binding Tempo2OrWidth}" Minimum="0" Maximum="16" Increment="1" FormatString="N0" MinWidth="80" />

          <TextBlock Grid.Row="2" Grid.Column="0" Text="Feedback 2:" Foreground="{StaticResource TextSecondary}"/>
          <StackPanel Grid.Row="2" Grid.Column="1" Orientation="Horizontal" Spacing="4">
            <NumericUpDown Value="{Binding ClipOrFeedback2}" Minimum="0" Maximum="120" Increment="1" FormatString="N0" MinWidth="80"
                           ToolTip.Tip="Dual: feedback for delay 2 (%)" />
            <TextBlock Text="%" VerticalAlignment="Center" Foreground="{StaticResource TextTertiary}" />
          </StackPanel>

          <TextBlock Grid.Row="3" Grid.Column="0" Text="Pan 1 / Pan 2:" Foreground="{StaticResource TextSecondary}"/>
          <StackPanel Grid.Row="3" Grid.Column="1" Orientation="Horizontal" Spacing="8">
            <NumericUpDown Value="{Binding OffsetOrPan1}" Minimum="-50" Maximum="50" Increment="1" FormatString="N0" MinWidth="70"
                           ToolTip.Tip="Dual: pan for delay 1 (-50 to 50)" />
            <NumericUpDown Value="{Binding SenseOrPan2}" Minimum="-50" Maximum="50" Increment="1" FormatString="N0" MinWidth="70"
                           ToolTip.Tip="Dual: pan for delay 2 (-50 to 50)" />
          </StackPanel>
        </Grid>
      </StackPanel>

      <StackPanel Spacing="8" IsVisible="{Binding IsPingPong}">
        <TextBlock Text="Ping-Pong" FontWeight="{StaticResource FontWeightSemiBold}" Foreground="{StaticResource TextPrimary}"/>
        <Grid ColumnDefinitions="160,*" RowDefinitions="Auto">
          <TextBlock Grid.Row="0" Grid.Column="0" Text="Width:" Foreground="{StaticResource TextSecondary}"/>
          <StackPanel Grid.Row="0" Grid.Column="1" Orientation="Horizontal" Spacing="4">
            <NumericUpDown Value="{Binding Tempo2OrWidth}" Minimum="0" Maximum="100" Increment="1" FormatString="N0" MinWidth="80"
                           ToolTip.Tip="Ping-pong stereo width (%)" />
            <TextBlock Text="%" VerticalAlignment="Center" Foreground="{StaticResource TextTertiary}" />
          </StackPanel>
        </Grid>
      </StackPanel>
    </StackPanel>
  </Border>
</UserControl>

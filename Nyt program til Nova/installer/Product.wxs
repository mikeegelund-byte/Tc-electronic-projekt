<?xml version="1.0" encoding="UTF-8"?>
<Wix xmlns="http://wixtoolset.org/schemas/v4/wxs">
  <Package Name="Nova System Manager" 
           Language="1033" 
           Version="1.0.0" 
           Manufacturer="TC Electronic Community" 
           UpgradeCode="A1B2C3D4-E5F6-4A5B-8C9D-0E1F2A3B4C5D"
           Platform="x64"
           InstallScope="perMachine"
           Compressed="yes">
    
    <SummaryInformation Description="MIDI Manager for TC Electronic Nova System"
                       Manufacturer="TC Electronic Community" 
                       Keywords="MIDI, TC Electronic, Nova System" />
    
    <MajorUpgrade DowngradeErrorMessage="A newer version of Nova System Manager is already installed." />
    <Media Id="1" Cabinet="product.cab" EmbedCab="yes" />
    
    <!-- Features -->
    <Feature Id="Complete" Title="Nova System Manager" Level="1">
      <ComponentGroupRef Id="PublishedFiles" />
      <ComponentGroupRef Id="ProgramMenuShortcuts" />
      <ComponentGroupRef Id="DesktopShortcut" />
    </Feature>
    
    <!-- Directory Structure -->
    <StandardDirectory Id="ProgramFiles64Folder">
      <Directory Id="INSTALLFOLDER" Name="NovaSystemManager" />
    </StandardDirectory>
    
    <StandardDirectory Id="ProgramMenuFolder">
      <Directory Id="ApplicationProgramsFolder" Name="Nova System Manager" />
    </StandardDirectory>
    
    <StandardDirectory Id="DesktopFolder" />
    
    <!-- Published files will be added by WiX heat tool (Components.wxs) -->
    
    <!-- Start Menu Shortcuts -->
    <ComponentGroup Id="ProgramMenuShortcuts" Directory="ApplicationProgramsFolder">
      <Component>
        <Shortcut Id="ApplicationStartMenuShortcut"
                  Name="Nova System Manager"
                  Description="MIDI Manager for TC Electronic Nova System"
                  Target="[INSTALLFOLDER]Nova.Presentation.exe"
                  WorkingDirectory="INSTALLFOLDER" />
        <RemoveFolder Id="CleanUpShortCut" On="uninstall" />
        <RegistryValue Root="HKCU" 
                      Key="Software\NovaSystemManager" 
                      Name="installed" 
                      Type="integer" 
                      Value="1" 
                      KeyPath="yes" />
      </Component>
    </ComponentGroup>
    
    <!-- Desktop Shortcut -->
    <ComponentGroup Id="DesktopShortcut" Directory="DesktopFolder">
      <Component>
        <Shortcut Id="DesktopShortcut"
                  Name="Nova System Manager"
                  Description="MIDI Manager for TC Electronic Nova System"
                  Target="[INSTALLFOLDER]Nova.Presentation.exe"
                  WorkingDirectory="INSTALLFOLDER" />
        <RegistryValue Root="HKCU" 
                      Key="Software\NovaSystemManager" 
                      Name="desktopShortcut" 
                      Type="integer" 
                      Value="1" 
                      KeyPath="yes" />
      </Component>
    </ComponentGroup>
    
  </Package>
</Wix>

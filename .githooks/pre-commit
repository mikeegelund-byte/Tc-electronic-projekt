#!/bin/bash
# Pre-commit hook: Verify build + basic tests
# Install: git config core.hooksPath .githooks

echo "üîç Pre-commit verification..."

# Check if solution exists
if [ ! -f "NovaApp.sln" ]; then
    echo "‚úÖ No solution found, skipping build check"
    exit 0
fi

# Build solution
echo "  Building solution..."
dotnet build NovaApp.sln --verbosity quiet --nologo > /dev/null 2>&1
if [ $? -ne 0 ]; then
    echo "‚ùå Build failed. Commit rejected."
    dotnet build NovaApp.sln --nologo
    exit 1
fi

echo "‚úÖ Build successful"

# Run fast tests (skip integration tests)
echo "  Running unit tests..."
dotnet test NovaApp.sln --filter "Category!=Integration" --verbosity quiet --nologo > /dev/null 2>&1
if [ $? -ne 0 ]; then
    echo "‚ö†Ô∏è  Some tests failed, but allowing commit (review before push)"
fi

echo "‚úÖ Pre-commit checks passed"
exit 0
